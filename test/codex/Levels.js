const { expect } = require("chai");
const { ethers } = require("hardhat");

const level_experience = [
  0, 1000, 2020, 3060, 4121, 5203, 6320, 7473, 8663, 9891, 11158, 12466, 13816,
  15209, 16647, 18135, 19671, 21256, 22892, 24580, 26322, 28099, 29912, 31761,
  33647, 35571, 37533, 39534, 41575, 43657, 45781, 47947, 50156, 52409, 54707,
  57085, 59546, 62093, 64729, 67457, 70280, 73193, 76199, 79301, 82502, 85805,
  89174, 92610, 96115, 99690, 103337, 107101, 110985, 114993, 119129, 123397,
  127750, 132190, 136719, 141339, 146051, 150914, 155933, 161113, 166459,
  171976, 177670, 183546, 189610, 195868, 202326, 209010, 215928, 223088,
  230499, 238169, 246107, 254323, 262827, 271629, 280739, 290141, 299844,
  309857, 320190, 330854, 341731, 352826, 364143, 375686, 387460, 399611,
  412151, 425092, 438447, 452229, 466452, 481130, 496278, 511911, 528044,
  544500, 561285, 578406, 595869, 613681, 631849, 650380, 669282, 688562,
  708228, 728582, 749648, 771451, 794017, 817373, 841546, 866565, 892460,
  919261, 947000, 975627, 1005170, 1035658, 1067122, 1099593, 1132713, 1166495,
  1200953, 1236100, 1271950, 1308517, 1345815, 1383859, 1422664, 1462245,
  1503093, 1545248, 1588752, 1633648, 1680115, 1728208, 1777984, 1829502,
  1882823, 1938010, 1995129, 2054247, 2115434, 2178763, 2244309, 5000000,
];

const next_level_experience = [
  1000, 2020, 3060, 4121, 5203, 6320, 7473, 8663, 9891, 11158, 12466, 13816,
  15209, 16647, 18135, 19671, 21256, 22892, 24580, 26322, 28099, 29912, 31761,
  33647, 35571, 37533, 39534, 41575, 43657, 45781, 47947, 50156, 52409, 54707,
  57085, 59546, 62093, 64729, 67457, 70280, 73193, 76199, 79301, 82502, 85805,
  89174, 92610, 96115, 99690, 103337, 107101, 110985, 114993, 119129, 123397,
  127750, 132190, 136719, 141339, 146051, 150914, 155933, 161113, 166459,
  171976, 177670, 183546, 189610, 195868, 202326, 209010, 215928, 223088,
  230499, 238169, 246107, 254323, 262827, 271629, 280739, 290141, 299844,
  309857, 320190, 330854, 341731, 352826, 364143, 375686, 387460, 399611,
  412151, 425092, 438447, 452229, 466452, 481130, 496278, 511911, 528044,
  544500, 561285, 578406, 595869, 613681, 631849, 650380, 669282, 688562,
  708228, 728582, 749648, 771451, 794017, 817373, 841546, 866565, 892460,
  919261, 947000, 975627, 1005170, 1035658, 1067122, 1099593, 1132713, 1166495,
  1200953, 1236100, 1271950, 1308517, 1345815, 1383859, 1422664, 1462245,
  1503093, 1545248, 1588752, 1633648, 1680115, 1728208, 1777984, 1829502,
  1882823, 1938010, 1995129, 2054247, 2115434, 2178763, 2244309, 5000000,
];

describe("Levels", () => {
  before(async () => {
    const Levels = await ethers.getContractFactory("Levels");
    this.levels = await Levels.deploy();
    await this.levels.deployed();
    await this.levels.initialize();
  });

  it("should match the levels correctly", async () => {
    let exp = 0;
    for (let i = 0; i <= 150; i++) {
      const level = await this.levels.getLevel(level_experience[i]);
      expect(level).to.eq(i);
    }
  });

  it("should match the levels correctly when experience is more than the lvl 150", async () => {
    const level = await this.levels.getLevel(10000000);
    expect(level).to.eq(150);
  });

  it("should match the required experience correctly", async () => {
    for (let i = 0; i <= 150; i++) {
      const experience = await this.levels.getExperience(i);
      expect(experience).to.eq(next_level_experience[i]);
    }
  });
});
